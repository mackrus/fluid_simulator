{"version":3,"file":"index-Ne2NvgXP.js","sources":["../../src/main.js"],"sourcesContent":["\nvar canvas = document.getElementById(\"myCanvas\");\nvar c = canvas.getContext(\"2d\");\ncanvas.width = window.innerWidth;\ncanvas.height = window.innerHeight;\n\ncanvas.focus();\n\nvar simHeight = 1.01;\nvar cScale = canvas.height / simHeight;\nvar simWidth = canvas.width / cScale;\n\nvar U_FIELD = 0;\nvar V_FIELD = 1;\nvar S_FIELD = 2;\n\nvar cnt = 0;\n\nfunction cX(x) {\n    return x * cScale;\n}\n\nfunction cY(y) {\n    return canvas.height - y * cScale;\n}\n\n// ----------------- start of simulator ------------------------------\n\nclass Fluid {\n    constructor(density, numX, numY, h) {\n        this.density = density;\n        this.numX = numX + 2;\n        this.numY = numY + 2;\n        this.numCells = this.numX * this.numY;\n        this.h = h;\n        this.u = new Float32Array(this.numCells);\n        this.v = new Float32Array(this.numCells);\n        this.newU = new Float32Array(this.numCells);\n        this.newV = new Float32Array(this.numCells);\n        this.p = new Float32Array(this.numCells);\n        this.s = new Float32Array(this.numCells);\n        this.m = new Float32Array(this.numCells);\n        this.newM = new Float32Array(this.numCells);\n        this.m.fill(1.0)\n        var num = numX * numY;\n    }\n\n\n    solveIncompressibility(numIters, dt) {\n\n        var n = this.numY;\n        var cp = this.density * this.h / dt;\n\n        for (var iter = 0; iter < numIters; iter++) {\n\n            for (var i = 1; i < this.numX - 1; i++) {\n                for (var j = 1; j < this.numY - 1; j++) {\n\n                    if (this.s[i * n + j] == 0.0)\n                        continue;\n\n                    var s = this.s[i * n + j];\n                    var sx0 = this.s[(i - 1) * n + j];\n                    var sx1 = this.s[(i + 1) * n + j];\n                    var sy0 = this.s[i * n + j - 1];\n                    var sy1 = this.s[i * n + j + 1];\n                    var s = sx0 + sx1 + sy0 + sy1;\n                    if (s == 0.0)\n                        continue;\n\n                    var div = this.u[(i + 1) * n + j] - this.u[i * n + j] +\n                        this.v[i * n + j + 1] - this.v[i * n + j];\n\n                    var p = -div / s;\n                    p *= scene.overRelaxation;\n                    this.p[i * n + j] += cp * p;\n\n                    this.u[i * n + j] -= sx0 * p;\n                    this.u[(i + 1) * n + j] += sx1 * p;\n                    this.v[i * n + j] -= sy0 * p;\n                    this.v[i * n + j + 1] += sy1 * p;\n                }\n            }\n        }\n    }\n\n\n    sampleField(x, y, field) {\n        var n = this.numY;\n        var h = this.h;\n        var h1 = 1.0 / h;\n        var h2 = 0.5 * h;\n\n        x = Math.max(Math.min(x, this.numX * h), h);\n        y = Math.max(Math.min(y, this.numY * h), h);\n\n        var dx = 0.0;\n        var dy = 0.0;\n\n        var f;\n\n        switch (field) {\n            case U_FIELD: f = this.u; dy = h2; break;\n            case V_FIELD: f = this.v; dx = h2; break;\n            case S_FIELD: f = this.m; dx = h2; dy = h2; break\n\n        }\n\n\n        var x0 = Math.min(Math.floor((x - dx) * h1), this.numX - 1);\n        var tx = ((x - dx) - x0 * h) * h1;\n        var x1 = Math.min(x0 + 1, this.numX - 1);\n\n        var y0 = Math.min(Math.floor((y - dy) * h1), this.numY - 1);\n        var ty = ((y - dy) - y0 * h) * h1;\n        var y1 = Math.min(y0 + 1, this.numY - 1);\n\n        var sx = 1.0 - tx;\n        var sy = 1.0 - ty;\n\n        var val = sx * sy * f[x0 * n + y0] +\n            tx * sy * f[x1 * n + y0] +\n            tx * ty * f[x1 * n + y1] +\n            sx * ty * f[x0 * n + y1];\n\n        return val;\n    }\n\n    avgU(i, j) {\n        var n = this.numY;\n        var u = (this.u[i * n + j - 1] + this.u[i * n + j] +\n            this.u[(i + 1) * n + j - 1] + this.u[(i + 1) * n + j]) * 0.25;\n        return u;\n\n    }\n\n    avgV(i, j) {\n        var n = this.numY;\n        var v = (this.v[(i - 1) * n + j] + this.v[i * n + j] +\n            this.v[(i - 1) * n + j + 1] + this.v[i * n + j + 1]) * 0.25;\n        return v;\n    }\n\n    advectVel(dt) {\n\n        this.newU.set(this.u);\n        this.newV.set(this.v);\n\n        var n = this.numY;\n        var h = this.h;\n        var h2 = 0.5 * h;\n\n        for (var i = 1; i < this.numX; i++) {\n            for (var j = 1; j < this.numY; j++) {\n\n                cnt++;\n\n                // u component\n                if (this.s[i * n + j] != 0.0 && this.s[(i - 1) * n + j] != 0.0 && j < this.numY - 1) {\n                    var x = i * h;\n                    var y = j * h + h2;\n                    var u = this.u[i * n + j];\n                    var v = this.avgV(i, j);\n                    //\t\t\t\t\t\tvar v = this.sampleField(x,y, V_FIELD);\n                    x = x - dt * u;\n                    y = y - dt * v;\n                    u = this.sampleField(x, y, U_FIELD);\n                    this.newU[i * n + j] = u;\n                }\n                // v component\n                if (this.s[i * n + j] != 0.0 && this.s[i * n + j - 1] != 0.0 && i < this.numX - 1) {\n                    var x = i * h + h2;\n                    var y = j * h;\n                    var u = this.avgU(i, j);\n                    //\t\t\t\t\t\tvar u = this.sampleField(x,y, U_FIELD);\n                    var v = this.v[i * n + j];\n                    x = x - dt * u;\n                    y = y - dt * v;\n                    v = this.sampleField(x, y, V_FIELD);\n                    this.newV[i * n + j] = v;\n                }\n            }\n        }\n\n        this.u.set(this.newU);\n        this.v.set(this.newV);\n    }\n\n    advectSmoke(dt) {\n\n        this.newM.set(this.m);\n\n        var n = this.numY;\n        var h = this.h;\n        var h2 = 0.5 * h;\n\n        for (var i = 1; i < this.numX - 1; i++) {\n            for (var j = 1; j < this.numY - 1; j++) {\n\n                if (this.s[i * n + j] != 0.0) {\n                    var u = (this.u[i * n + j] + this.u[(i + 1) * n + j]) * 0.5;\n                    var v = (this.v[i * n + j] + this.v[i * n + j + 1]) * 0.5;\n                    var x = i * h + h2 - dt * u;\n                    var y = j * h + h2 - dt * v;\n\n                    this.newM[i * n + j] = this.sampleField(x, y, S_FIELD);\n                }\n            }\n        }\n        this.m.set(this.newM);\n    }\n\n    // ----------------- end of simulator ------------------------------\n\n\n    simulate(dt, numIters) {\n\n        this.solveIncompressibility(numIters, dt);\n        this.advectVel(dt);\n        this.advectSmoke(dt);\n    }\n}\n\nvar scene =\n{\n    dt: 1.0 / 120.0,\n    numIters: 100,\n    frameNr: 0,\n    overRelaxation: 1.9,\n    obstacleX: 2.0,\n    obstacleY: 0.0,\n    obstacleRadius: 0.15,\n    paused: false,\n    sceneNr: 0,\n    fluid: null\n};\n\n\n\nfunction setupScene(sceneNr = 0) {\n    scene.sceneNr = sceneNr;\n    scene.obstacleRadius = 0.1;\n    scene.overRelaxation = 1.85;\n\n    scene.dt = 1.0 / 120.0;\n    scene.numIters = 20;\n\n    var res = 210;\n\n    var domainHeight = 1.0;\n    var domainWidth = domainHeight / simHeight * simWidth;\n    var h = domainHeight / res;\n\n    var numX = Math.floor(domainWidth / h);\n    var numY = Math.floor(domainHeight / h);\n\n    var density = 1000.0;\n\n\n    var f = scene.fluid = new Fluid(density, numX, numY, h);\n\n\n    var n = f.numY;\n\n\n    if (sceneNr == 1) { // vortex shedding\n\n        var inVel = 4.0;\n        for (var i = 0; i < f.numX; i++) {\n            for (var j = 0; j < f.numY; j++) {\n                var s = 1.9;\t// fluid\n                if (i == 0 || j == 0 || j == f.numY - 1)\n                    s = 0.001;\t// solid\n                f.s[i * n + j] = s\n\n                if (i == 1) {\n                    f.u[i * n + j] = inVel;\n                }\n            }\n        }\n\n        var pipeH = 0.1 * f.numY;\n        var minJ = Math.floor(0.5 * f.numY - 0.5 * pipeH);\n        var maxJ = Math.floor(0.5 * f.numY + 0.5 * pipeH);\n\n        for (var j = minJ; j < maxJ; j++)\n            f.m[j] = 0.0;\n\n        setObstacle(0.4, 0.5, true)\n    }\n\n}\n\n\n// draw -------------------------------------------------------\n\n\nfunction draw() {\n    c.clearRect(0, 0, canvas.width, canvas.height);\n\n    c.fillStyle = \"#000000\";\n    var f = scene.fluid;\n    var n = f.numY;\n\n    var cellScale = 1;\n\n    var h = f.h;\n\n    var minP = f.p[0];\n    var maxP = f.p[0];\n\n    for (var i = 0; i < f.numCells; i++) {\n        minP = Math.min(minP, f.p[i]);\n        maxP = Math.max(maxP, f.p[i]);\n    }\n\n    var id = c.getImageData(0, 0, canvas.width, canvas.height)\n\n    var color = [0, 0, 0, 0]\n\n    for (var i = 0; i < f.numX; i++) {\n        for (var j = 0; j < f.numY; j++) {\n\n\n            var s = 1 - f.m[i * n + j];\n            color[0] = 590 * s;\n            color[1] = 250 * s;\n            color[2] = 2500 * s;\n\n            var x = Math.floor(cX(i * h));\n            var y = Math.floor(cY((j + 1) * h));\n            var cx = Math.floor(cScale * cellScale * h) + 1;\n            var cy = Math.floor(cScale * cellScale * h) + 1;\n\n            var r = color[0];\n            var g = color[1];\n            var b = color[2];\n\n            for (var yi = y; yi < y + cy; yi++) {\n                var p = 4 * (yi * canvas.width + x)\n\n                for (var xi = 0; xi < cx; xi++) {\n                    id.data[p++] = r;\n                    id.data[p++] = g;\n                    id.data[p++] = b;\n                    id.data[p++] = 100;\n                }\n            }\n        }\n    }\n\n    c.putImageData(id, 0, 0);\n\n    if (scene.showObstacle) {\n\n        c.strokeW\n        r = scene.obstacleRadius + f.h;\n        c.fillStyle = \"#000000\";  // Hex color for circle\n        c.beginPath();\n        c.arc(\n            cX(scene.obstacleX), cY(scene.obstacleY), cScale * r, 0.0, 2.0 * Math.PI);\n        c.closePath();\n        c.fill();\n\n        c.lineWidth = 0.4;\n        c.strokeStyle = \"#DDDDDD\";\n        c.beginPath();\n        c.arc(\n            cX(scene.obstacleX), cY(scene.obstacleY), cScale * r, 0.0, 2.0 * Math.PI);\n        c.closePath();\n        c.stroke();\n        c.lineWidth = 0.05;\n    }\n\n\n}\n\nfunction setObstacle(x, y, reset) {\n\n    var vx = 0.0;\n    var vy = 0.0;\n\n    if (!reset) {\n        vx = (x - scene.obstacleX) / scene.dt;\n        vy = (y - scene.obstacleY) / scene.dt;\n    }\n\n    scene.obstacleX = x;\n    scene.obstacleY = y;\n    var r = scene.obstacleRadius;\n    var f = scene.fluid;\n    var n = f.numY;\n    var cd = Math.sqrt(2) * f.h;\n\n    for (var i = 1; i < f.numX - 2; i++) {\n        for (var j = 1; j < f.numY - 2; j++) {\n\n            f.s[i * n + j] = 1.0;\n\n            var dx = (i + 0.5) * f.h - x;\n            var dy = (j + 0.5) * f.h - y;\n\n\n            if (dx * dx + dy * dy < r * r) {\n                f.s[i * n + j] = 0.0;\n                if (scene.sceneNr == 2)\n                    f.m[i * n + j] = 0.5 + 0.5 * Math.sin(0.1 * scene.frameNr)\n                else\n                    f.m[i * n + j] = 1.0;\n                f.u[i * n + j] = vx;\n                f.u[(i + 1) * n + j] = vx;\n                f.v[i * n + j] = vy;\n                f.v[i * n + j + 1] = vy;\n            }\n        }\n    }\n\n    scene.showObstacle = true;\n}\n\n// interaction -------------------------------------------------------\n\nvar mouseDown = false;\n\nfunction startDrag(x, y) {\n    let bounds = canvas.getBoundingClientRect();\n\n    let mx = x - bounds.left - canvas.clientLeft;\n    let my = y - bounds.top - canvas.clientTop;\n    mouseDown = true;\n\n    x = mx / cScale;\n    y = (canvas.height - my) / cScale;\n\n    setObstacle(x, y, true);\n}\n\nfunction drag(x, y) {\n    if (mouseDown) {\n        let bounds = canvas.getBoundingClientRect();\n        let mx = x - bounds.left - canvas.clientLeft;\n        let my = y - bounds.top - canvas.clientTop;\n        x = mx / cScale;\n        y = (canvas.height - my) / cScale;\n        setObstacle(x, y, false);\n    }\n}\n\nfunction endDrag() {\n    mouseDown = false;\n}\n\ncanvas.addEventListener('mousedown', event => {\n    startDrag(event.x, event.y);\n});\n\ncanvas.addEventListener('mouseup', event => {\n    endDrag();\n});\n\ncanvas.addEventListener('mousemove', event => {\n    drag(event.x, event.y);\n});\n\ncanvas.addEventListener('touchstart', event => {\n    startDrag(event.touches[0].clientX, event.touches[0].clientY)\n});\n\ncanvas.addEventListener('touchend', event => {\n    endDrag()\n});\n\ncanvas.addEventListener('touchmove', event => {\n    event.preventDefault();\n    event.stopImmediatePropagation();\n    drag(event.touches[0].clientX, event.touches[0].clientY)\n}, { passive: false });\n\n\n// main -------------------------------------------------------\n\nfunction simulate() {\n    if (!scene.paused)\n        scene.fluid.simulate(scene.dt, scene.numIters)\n    scene.frameNr++;\n}\n\nfunction update() {\n    simulate();\n    draw();\n    requestAnimationFrame(update);\n}\n\nsetupScene(1);\nupdate();\n"],"names":["canvas","c","simHeight","cScale","simWidth","U_FIELD","V_FIELD","S_FIELD","cX","x","cY","y","Fluid","density","numX","numY","h","numIters","dt","n","cp","iter","i","j","s","sx0","sx1","sy0","sy1","div","p","scene","field","h1","h2","dx","dy","f","x0","tx","x1","y0","ty","y1","sx","sy","val","u","v","setupScene","sceneNr","res","domainHeight","domainWidth","inVel","pipeH","minJ","maxJ","setObstacle","draw","cellScale","minP","maxP","id","color","cx","cy","r","g","b","yi","xi","reset","vx","vy","mouseDown","startDrag","bounds","mx","my","drag","endDrag","event","simulate","update"],"mappings":"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"}